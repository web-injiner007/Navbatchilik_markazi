<!-- templates/ipapp/dashboard.html -->
<!DOCTYPE html>
<html>
<head>
    <title>IP Manzillar Birlashgan Sahifa</title>

    <script>
        function showTableModal(hudud) {
            document.getElementById('table-modal-' + hudud).style.display = 'block';
        }
        function closeTableModal(hudud) {
            document.getElementById('table-modal-' + hudud).style.display = 'none';
        }
        function showDetailModal(ipId) {
            document.getElementById('detail-modal-' + ipId).style.display = 'block';
        }
        function closeDetailModal(ipId) {
            document.getElementById('detail-modal-' + ipId).style.display = 'none';
        }
    </script>
</head>

<style>
    /* static/ipapp/style.css */
body {
    font-family: Arial, sans-serif;
    margin: 40px;
    background-color: #f0f0f0;
}
h1, h2, h3 {
    color: #333;
}
ul {
    list-style: none;
    padding: 0;
}
ul li {
    margin-bottom: 10px;
}
a {
    color: #0066cc;
    text-decoration: none;
}
a:hover {
    text-decoration: underline;
}
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}
table, th, td {
    border: 1px solid #ccc;
}
th, td {
    padding: 10px;
    text-align: left;
}
tr:hover {
    background-color: #e0e0e0;
    cursor: pointer;
}
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0; top: 0;
    width: 100%; height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.5);
}
.modal-content {
    background-color: #fff;
    margin: 5% auto;
    padding: 20px;
    border-radius: 8px;
    width: 90%;
    max-width: 900px;
}
.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}
.close:hover {
    color: black;
    cursor: pointer;
}

</style>

<body>
    <h1>IP Manzillar Bazasi</h1>

    <ul>
        {% for hudud in hududlar %}
            <li><a href="javascript:void(0);" onclick="showTableModal('{{ hudud }}')">{{ hudud }}</a></li>

            <!-- Jadval Modal -->
            <div id="table-modal-{{ hudud }}" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeTableModal('{{ hudud }}')">&times;</span>
                    <h2>{{ hudud }} hududidagi IP manzillar</h2>
                    <table>
                        <tr>
                            <th>Nomeri</th>
                            <th>IP Manzili</th>
                            <th>Kategoriya</th>
                            <th>Faollik</th>
                        </tr>
                        {% for ip in iplar %}
                            {% if ip.hudud == hudud %}
                            <tr onclick="showDetailModal({{ ip.id }})" style="cursor:pointer;">
                                <td>{{ ip.nomeri }}</td>
                                <td>{{ ip.ip_manzili }}</td>
                                <td>{{ ip.kategoriya }}</td>
                                <td>{{ ip.is_active|yesno:"Faol,Faol emas" }}</td>
                            </tr>

                            <!-- IP Detail Modal -->
                            <div id="detail-modal-{{ ip.id }}" class="modal">
                                <div class="modal-content">
                                    <span class="close" onclick="closeDetailModal({{ ip.id }})">&times;</span>
                                    <h2>{{ ip.nomeri }} - IP Ma’lumotlari</h2>
                                    <ul>
                                        <li><strong>IP:</strong> {{ ip.ip_manzili }}</li>
                                        <li><strong>Kategoriya:</strong> {{ ip.kategoriya }}</li>
                                        <li><strong>Hudud:</strong> {{ ip.hudud }}</li>
                                        <li><strong>Model:</strong> {{ ip.model }}</li>
                                        <li><strong>Yil:</strong> {{ ip.yil }}</li>
                                        <li><strong>Joylashuvi:</strong> {{ ip.jolashuvi }}</li>
                                        <li><strong>Koordinatalar:</strong> {{ ip.koorX }}, {{ ip.koorY }}</li>
                                        <li><strong>Oxirgi tekshiruv:</strong> {{ ip.last_checked }}</li>
                                    </ul>
                                    <h3>To‘liq Ma’lumot</h3>
                                    <div>{{ ip.toliq_mal|safe }}</div>
                                    <h3>Javobgar Shaxs</h3>
                                    <div>{{ ip.javob_shax|safe }}</div>
                                    <h3>Ichki Nomer</h3>
                                    <div>{{ ip.ichki_nomer|safe }}</div>
                                </div>
                            </div>
                            {% endif %}
                        {% endfor %}
                    </table>
                </div>
            </div>
        {% endfor %}
    </ul>
</body>
</html>
